/*
Deployment script for LECDB

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "LECDB"
:setvar DefaultFilePrefix "LECDB"
:setvar DefaultDataPath "C:\Program Files\Microsoft SQL Server\MSSQL14.SQLEXPRESS\MSSQL\DATA\"
:setvar DefaultLogPath "C:\Program Files\Microsoft SQL Server\MSSQL14.SQLEXPRESS\MSSQL\DATA\"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [$(DatabaseName)];


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET ANSI_NULLS ON,
                ANSI_PADDING ON,
                ANSI_WARNINGS ON,
                ARITHABORT ON,
                CONCAT_NULL_YIELDS_NULL ON,
                QUOTED_IDENTIFIER ON,
                ANSI_NULL_DEFAULT ON,
                CURSOR_DEFAULT LOCAL,
                RECOVERY FULL 
            WITH ROLLBACK IMMEDIATE;
    END


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET PAGE_VERIFY NONE 
            WITH ROLLBACK IMMEDIATE;
    END


GO
ALTER DATABASE [$(DatabaseName)]
    SET TARGET_RECOVERY_TIME = 0 SECONDS 
    WITH ROLLBACK IMMEDIATE;


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET QUERY_STORE (CLEANUP_POLICY = (STALE_QUERY_THRESHOLD_DAYS = 367)) 
            WITH ROLLBACK IMMEDIATE;
    END


GO
PRINT N'Rename refactoring operation with key f0a0c595-f335-48ea-92d8-f378cdd6ba71 is skipped, element [dbo].[Match].[Id] (SqlSimpleColumn) will not be renamed to MatchID';


GO
PRINT N'Rename refactoring operation with key bf87c9a1-30a4-4a44-afcf-29939fa59b27 is skipped, element [dbo].[Team].[Id] (SqlSimpleColumn) will not be renamed to TeamID';


GO
PRINT N'Rename refactoring operation with key 46c18766-5333-4a6b-9810-2904b5eda2f2 is skipped, element [dbo].[Schedule].[Id] (SqlSimpleColumn) will not be renamed to ScheduleID';


GO
PRINT N'Rename refactoring operation with key 8f4bac8c-7931-4323-8a92-0b3636896154 is skipped, element [dbo].[ScheduledMatch].[Id] (SqlSimpleColumn) will not be renamed to MatchID';


GO
PRINT N'Rename refactoring operation with key 492c7750-c910-4c18-b4dd-dc6a6a7bfdfd is skipped, element [dbo].[User].[Id] (SqlSimpleColumn) will not be renamed to UserID';


GO
PRINT N'Rename refactoring operation with key e10332e6-953a-4042-b6d0-d68f4db19d6f is skipped, element [dbo].[Ticket].[Id] (SqlSimpleColumn) will not be renamed to TicketID';


GO
PRINT N'Rename refactoring operation with key e697a75e-c862-4477-af4f-619cdffa84a6 is skipped, element [dbo].[MatchTicket].[Id] (SqlSimpleColumn) will not be renamed to MatchID';


GO
PRINT N'Rename refactoring operation with key 5537c09a-ad21-46ae-aaab-d7f7c5082d97, 4b3901bb-d881-42de-9eb7-275cd45fb169 is skipped, element [dbo].[Standing].[Id] (SqlSimpleColumn) will not be renamed to TeamID';


GO
PRINT N'Rename refactoring operation with key 8a35aede-abc9-4fca-9f24-1d179cb148ee is skipped, element [dbo].[TeamStaff].[Id] (SqlSimpleColumn) will not be renamed to TeamStaffID';


GO
PRINT N'Rename refactoring operation with key f4a18c36-b9db-44aa-aef6-dabf71f9d9aa is skipped, element [dbo].[WorksForTeam].[Id] (SqlSimpleColumn) will not be renamed to WorksForTeamID';


GO
PRINT N'Rename refactoring operation with key 5f421b39-71c1-4895-a163-152e7da78185 is skipped, element [dbo].[FeaturesInMedia].[Id] (SqlSimpleColumn) will not be renamed to WorksForTeamID';


GO
PRINT N'Rename refactoring operation with key da648b40-ec0e-4c2e-9de7-76495f5762fd is skipped, element [dbo].[Media].[Id] (SqlSimpleColumn) will not be renamed to MediaID';


GO
PRINT N'Rename refactoring operation with key 8600449f-7300-46aa-b821-eb092f2b9af3 is skipped, element [dbo].[Employee].[Id] (SqlSimpleColumn) will not be renamed to EmployeeID';


GO
PRINT N'Rename refactoring operation with key 3a7dc3d6-4d8c-4f5d-b342-0440da1c9e88 is skipped, element [dbo].[Caster].[Id] (SqlSimpleColumn) will not be renamed to CasterID';


GO
PRINT N'Rename refactoring operation with key 2169d87d-d83e-4312-aa4d-e7c821de21ba is skipped, element [dbo].[Host].[Id] (SqlSimpleColumn) will not be renamed to HostID';


GO
PRINT N'Rename refactoring operation with key 2194103b-69fc-4c35-b499-9b7e0ae25bfd is skipped, element [dbo].[AnalyticalCaster].[Id] (SqlSimpleColumn) will not be renamed to ACasterID';


GO
PRINT N'Rename refactoring operation with key c64b7ff7-1004-4522-8d66-b4fb49d01040 is skipped, element [dbo].[Match].[TeamAID] (SqlSimpleColumn) will not be renamed to TeamA_ID';


GO
PRINT N'Rename refactoring operation with key f62f9224-3805-4644-8b23-a09c288f9170 is skipped, element [dbo].[Match].[TeamBID] (SqlSimpleColumn) will not be renamed to TeamB_ID';


GO
PRINT N'Rename refactoring operation with key 9ebc9d4b-e4f3-40ee-8611-135f1d5adab2 is skipped, element [dbo].[IsOn].[Id] (SqlSimpleColumn) will not be renamed to ACasterID';


GO
PRINT N'Rename refactoring operation with key a4ad704b-d506-404d-be1e-135fe64f5e71 is skipped, element [dbo].[Match].[Id] (SqlSimpleColumn) will not be renamed to MatchID';


GO
PRINT N'Rename refactoring operation with key 5e12ef8a-1c24-4119-ab08-ac3721359558 is skipped, element [dbo].[Team].[Id] (SqlSimpleColumn) will not be renamed to TeamID';


GO
PRINT N'Rename refactoring operation with key 39a98983-adb9-4097-a220-99b091c5c7ae is skipped, element [dbo].[Schedule].[Id] (SqlSimpleColumn) will not be renamed to ScheduleID';


GO
PRINT N'Rename refactoring operation with key d9d90403-6d42-42af-b66b-8f761a67b3c0 is skipped, element [dbo].[ScheduledMatch].[Id] (SqlSimpleColumn) will not be renamed to MatchID';


GO
PRINT N'Rename refactoring operation with key 220b58a0-89b9-45de-baf0-3f4f088bc0c7 is skipped, element [dbo].[User].[Id] (SqlSimpleColumn) will not be renamed to UserID';


GO
PRINT N'Rename refactoring operation with key cb1d74cd-ed82-412a-9ed6-bca9c0a3de29 is skipped, element [dbo].[User].[Emai] (SqlSimpleColumn) will not be renamed to Email';


GO
PRINT N'Rename refactoring operation with key 439209e9-0301-4e45-bca5-f72684c7c306 is skipped, element [dbo].[Ticket].[Id] (SqlSimpleColumn) will not be renamed to TicketID';


GO
PRINT N'Rename refactoring operation with key d567db1c-efd6-493a-8cdb-fcd543fd7c6f is skipped, element [dbo].[MatchTicket].[Id] (SqlSimpleColumn) will not be renamed to MatchID';


GO
PRINT N'Rename refactoring operation with key eed50385-7b32-4733-8d44-c43661d1b4e5 is skipped, element [dbo].[MatchTicket].[Ticket] (SqlSimpleColumn) will not be renamed to TicketID';


GO
PRINT N'Rename refactoring operation with key dcb32c6b-ded7-418c-847c-0e155b60eaef is skipped, element [dbo].[Standing].[Id] (SqlSimpleColumn) will not be renamed to TeamID';


GO
PRINT N'Rename refactoring operation with key 6dd66ec2-5b9e-42b1-8ffc-cf3959be9c56 is skipped, element [dbo].[TeamStaff].[Id] (SqlSimpleColumn) will not be renamed to TeamStaffID';


GO
PRINT N'Rename refactoring operation with key 12bb863f-a045-4f8f-becf-4b33ae8d5e2c is skipped, element [dbo].[TeamStaff].[Salart] (SqlSimpleColumn) will not be renamed to Salary';


GO
PRINT N'Rename refactoring operation with key 7ae07983-c870-4037-bdc9-fa0a3e0ebc2b is skipped, element [dbo].[WorksForTeam].[Id] (SqlSimpleColumn) will not be renamed to WorksForTeamID';


GO
PRINT N'Rename refactoring operation with key d778d721-0005-42ef-974e-229175f97d0a is skipped, element [dbo].[FeaturesInMedia].[Id] (SqlSimpleColumn) will not be renamed to WorksForTeamID';


GO
PRINT N'Rename refactoring operation with key 21285f1b-a207-4d74-b2b5-ee03be67b7a0 is skipped, element [dbo].[Media].[Id] (SqlSimpleColumn) will not be renamed to MediaID';


GO
PRINT N'Rename refactoring operation with key 96ed880c-06fd-4bbb-8a9c-b097b1d38433 is skipped, element [dbo].[IsOnMedia].[Id] (SqlSimpleColumn) will not be renamed to ACasterID';


GO
PRINT N'Creating [dbo].[AnalyticalCaster]...';


GO
CREATE TABLE [dbo].[AnalyticalCaster] (
    [ACasterID]      INT        IDENTITY (1, 1) NOT NULL,
    [PredictionRate] FLOAT (53) NOT NULL,
    [Expertise]      NCHAR (10) NULL,
    CONSTRAINT [AnalyticalCaster_PK] PRIMARY KEY CLUSTERED ([ACasterID] ASC)
);


GO
PRINT N'Creating [dbo].[Caster]...';


GO
CREATE TABLE [dbo].[Caster] (
    [CasterID]     INT          IDENTITY (1, 1) NOT NULL,
    [CastingStyle] VARCHAR (20) NOT NULL,
    CONSTRAINT [Caster_PK] PRIMARY KEY CLUSTERED ([CasterID] ASC)
);


GO
PRINT N'Creating [dbo].[Employee]...';


GO
CREATE TABLE [dbo].[Employee] (
    [EmployeeID] INT          IDENTITY (1, 1) NOT NULL,
    [FirstName]  VARCHAR (20) NOT NULL,
    [LastName]   VARCHAR (20) NOT NULL,
    [InGameName] VARCHAR (20) NOT NULL,
    [BirthDate]  DATETIME     NOT NULL,
    CONSTRAINT [Employee_PK] PRIMARY KEY CLUSTERED ([EmployeeID] ASC)
);


GO
PRINT N'Creating [dbo].[FeaturesInMedia]...';


GO
CREATE TABLE [dbo].[FeaturesInMedia] (
    [WorksForTeamID] INT NOT NULL,
    [MediaID]        INT NOT NULL,
    CONSTRAINT [FeaturesInMedia_PK] PRIMARY KEY CLUSTERED ([MediaID] ASC, [WorksForTeamID] ASC)
);


GO
PRINT N'Creating [dbo].[Host]...';


GO
CREATE TABLE [dbo].[Host] (
    [HostID]      INT           IDENTITY (1, 1) NOT NULL,
    [Description] VARCHAR (200) NULL,
    CONSTRAINT [Host_PK] PRIMARY KEY CLUSTERED ([HostID] ASC)
);


GO
PRINT N'Creating [dbo].[IsOnMedia]...';


GO
CREATE TABLE [dbo].[IsOnMedia] (
    [ACasterID] INT NOT NULL,
    [MediaID]   INT NOT NULL,
    CONSTRAINT [IsOnMedia_PK] PRIMARY KEY CLUSTERED ([MediaID] ASC, [ACasterID] ASC)
);


GO
PRINT N'Creating [dbo].[Match]...';


GO
CREATE TABLE [dbo].[Match] (
    [MatchID]       INT          IDENTITY (1, 1) NOT NULL,
    [MatchName]     VARCHAR (20) NOT NULL,
    [StartTime]     DATETIME     NOT NULL,
    [MatchFavorite] VARCHAR (20) NULL,
    [TeamA_ID]      INT          NOT NULL,
    [TeamB_ID]      INT          NOT NULL,
    [Caster_ID]     INT          NOT NULL,
    CONSTRAINT [Match_PK] PRIMARY KEY CLUSTERED ([MatchID] ASC)
);


GO
PRINT N'Creating [dbo].[MatchTicket]...';


GO
CREATE TABLE [dbo].[MatchTicket] (
    [MatchID]  INT NOT NULL,
    [UserID]   INT NOT NULL,
    [TicketID] INT NOT NULL
);


GO
PRINT N'Creating [dbo].[Media]...';


GO
CREATE TABLE [dbo].[Media] (
    [MediaID]     INT          IDENTITY (1, 1) NOT NULL,
    [ShowName]    VARCHAR (20) NOT NULL,
    [Length]      TIME (7)     NOT NULL,
    [ReleaseDate] DATE         NOT NULL,
    CONSTRAINT [Media_PK] PRIMARY KEY CLUSTERED ([MediaID] ASC)
);


GO
PRINT N'Creating [dbo].[Schedule]...';


GO
CREATE TABLE [dbo].[Schedule] (
    [ScheduleID]       INT           IDENTITY (1, 1) NOT NULL,
    [Name]             VARCHAR (20)  NOT NULL,
    [MatchOfTheDay]    VARCHAR (20)  NOT NULL,
    [MatchDescription] VARCHAR (100) NULL,
    CONSTRAINT [Schedule_PK] PRIMARY KEY CLUSTERED ([ScheduleID] ASC)
);


GO
PRINT N'Creating [dbo].[ScheduledMatch]...';


GO
CREATE TABLE [dbo].[ScheduledMatch] (
    [MatchID]    INT NOT NULL,
    [ScheduleID] INT NOT NULL,
    CONSTRAINT [ScheduledMatch_PK] PRIMARY KEY CLUSTERED ([ScheduleID] ASC, [MatchID] ASC)
);


GO
PRINT N'Creating [dbo].[Standing]...';


GO
CREATE TABLE [dbo].[Standing] (
    [TeamID] INT IDENTITY (1, 1) NOT NULL,
    [Wins]   INT NOT NULL,
    [Loses]  INT NOT NULL,
    [Rank]   INT NOT NULL,
    CONSTRAINT [Standing_PK] PRIMARY KEY CLUSTERED ([TeamID] ASC)
);


GO
PRINT N'Creating [dbo].[Team]...';


GO
CREATE TABLE [dbo].[Team] (
    [TeamID]       INT           IDENTITY (1, 1) NOT NULL,
    [TeamName]     VARCHAR (20)  NOT NULL,
    [Description]  VARCHAR (200) NOT NULL,
    [HeadQuarters] VARCHAR (20)  NOT NULL,
    CONSTRAINT [Team_PK] PRIMARY KEY CLUSTERED ([TeamID] ASC)
);


GO
PRINT N'Creating [dbo].[TeamStaff]...';


GO
CREATE TABLE [dbo].[TeamStaff] (
    [TeamStaffID] INT          IDENTITY (1, 1) NOT NULL,
    [FirstName]   VARCHAR (20) NOT NULL,
    [LastName]    VARCHAR (20) NOT NULL,
    [InGameName]  VARCHAR (20) NOT NULL,
    [Salary]      INT          NOT NULL,
    [Country]     VARCHAR (20) NOT NULL,
    [Position]    VARCHAR (20) NOT NULL,
    CONSTRAINT [TeamStaff_PK] PRIMARY KEY CLUSTERED ([TeamStaffID] ASC)
);


GO
PRINT N'Creating [dbo].[Ticket]...';


GO
CREATE TABLE [dbo].[Ticket] (
    [TicketID]  INT          IDENTITY (1, 1) NOT NULL,
    [Row]       INT          NOT NULL,
    [Seat]      INT          NOT NULL,
    [Price]     FLOAT (53)   NOT NULL,
    [Location]  VARCHAR (20) NOT NULL,
    [MatchName] VARCHAR (20) NOT NULL,
    CONSTRAINT [Ticket_PK] PRIMARY KEY CLUSTERED ([TicketID] ASC)
);


GO
PRINT N'Creating [dbo].[User]...';


GO
CREATE TABLE [dbo].[User] (
    [UserID]    INT          IDENTITY (1, 1) NOT NULL,
    [Username]  VARCHAR (20) NOT NULL,
    [Password]  VARCHAR (20) NOT NULL,
    [Email]     VARCHAR (20) NOT NULL,
    [FirstName] VARCHAR (20) NOT NULL,
    [LastName]  VARCHAR (20) NOT NULL,
    CONSTRAINT [User_PK] PRIMARY KEY CLUSTERED ([UserID] ASC)
);


GO
PRINT N'Creating [dbo].[WorksForTeam]...';


GO
CREATE TABLE [dbo].[WorksForTeam] (
    [WorksForTeamID] INT IDENTITY (1, 1) NOT NULL,
    [TeamStaffID]    INT NOT NULL,
    [TeamID]         INT NOT NULL,
    CONSTRAINT [WorksForTeam_PK] PRIMARY KEY CLUSTERED ([WorksForTeamID] ASC)
);


GO
PRINT N'Creating [dbo].[AnalyticalCaster_FK]...';


GO
ALTER TABLE [dbo].[AnalyticalCaster] WITH NOCHECK
    ADD CONSTRAINT [AnalyticalCaster_FK] FOREIGN KEY ([ACasterID]) REFERENCES [dbo].[Employee] ([EmployeeID]);


GO
PRINT N'Creating [dbo].[Caster_FK]...';


GO
ALTER TABLE [dbo].[Caster] WITH NOCHECK
    ADD CONSTRAINT [Caster_FK] FOREIGN KEY ([CasterID]) REFERENCES [dbo].[Employee] ([EmployeeID]);


GO
PRINT N'Creating [dbo].[FeaturesInMedia_FK]...';


GO
ALTER TABLE [dbo].[FeaturesInMedia] WITH NOCHECK
    ADD CONSTRAINT [FeaturesInMedia_FK] FOREIGN KEY ([MediaID]) REFERENCES [dbo].[Media] ([MediaID]);


GO
PRINT N'Creating [dbo].[FeaturesInMedia_FK2]...';


GO
ALTER TABLE [dbo].[FeaturesInMedia] WITH NOCHECK
    ADD CONSTRAINT [FeaturesInMedia_FK2] FOREIGN KEY ([WorksForTeamID]) REFERENCES [dbo].[WorksForTeam] ([WorksForTeamID]);


GO
PRINT N'Creating [dbo].[Host_FK]...';


GO
ALTER TABLE [dbo].[Host] WITH NOCHECK
    ADD CONSTRAINT [Host_FK] FOREIGN KEY ([HostID]) REFERENCES [dbo].[Employee] ([EmployeeID]);


GO
PRINT N'Creating [dbo].[IsOnMedia_FK]...';


GO
ALTER TABLE [dbo].[IsOnMedia] WITH NOCHECK
    ADD CONSTRAINT [IsOnMedia_FK] FOREIGN KEY ([MediaID]) REFERENCES [dbo].[Media] ([MediaID]);


GO
PRINT N'Creating [dbo].[IsOnMedia_FK2]...';


GO
ALTER TABLE [dbo].[IsOnMedia] WITH NOCHECK
    ADD CONSTRAINT [IsOnMedia_FK2] FOREIGN KEY ([ACasterID]) REFERENCES [dbo].[AnalyticalCaster] ([ACasterID]);


GO
PRINT N'Creating [dbo].[Match_FK]...';


GO
ALTER TABLE [dbo].[Match] WITH NOCHECK
    ADD CONSTRAINT [Match_FK] FOREIGN KEY ([TeamA_ID]) REFERENCES [dbo].[Team] ([TeamID]);


GO
PRINT N'Creating [dbo].[Match_FK2]...';


GO
ALTER TABLE [dbo].[Match] WITH NOCHECK
    ADD CONSTRAINT [Match_FK2] FOREIGN KEY ([TeamB_ID]) REFERENCES [dbo].[Team] ([TeamID]);


GO
PRINT N'Creating [dbo].[Match_FK3]...';


GO
ALTER TABLE [dbo].[Match] WITH NOCHECK
    ADD CONSTRAINT [Match_FK3] FOREIGN KEY ([Caster_ID]) REFERENCES [dbo].[Caster] ([CasterID]);


GO
PRINT N'Creating [dbo].[MatchTicket_FK]...';


GO
ALTER TABLE [dbo].[MatchTicket] WITH NOCHECK
    ADD CONSTRAINT [MatchTicket_FK] FOREIGN KEY ([MatchID]) REFERENCES [dbo].[Match] ([MatchID]);


GO
PRINT N'Creating [dbo].[MatchTicket_FK2]...';


GO
ALTER TABLE [dbo].[MatchTicket] WITH NOCHECK
    ADD CONSTRAINT [MatchTicket_FK2] FOREIGN KEY ([UserID]) REFERENCES [dbo].[User] ([UserID]);


GO
PRINT N'Creating [dbo].[MatchTicket_FK3]...';


GO
ALTER TABLE [dbo].[MatchTicket] WITH NOCHECK
    ADD CONSTRAINT [MatchTicket_FK3] FOREIGN KEY ([TicketID]) REFERENCES [dbo].[Ticket] ([TicketID]);


GO
PRINT N'Creating [dbo].[ScheduledMatch_FK]...';


GO
ALTER TABLE [dbo].[ScheduledMatch] WITH NOCHECK
    ADD CONSTRAINT [ScheduledMatch_FK] FOREIGN KEY ([ScheduleID]) REFERENCES [dbo].[Schedule] ([ScheduleID]);


GO
PRINT N'Creating [dbo].[ScheduledMatch_FK2]...';


GO
ALTER TABLE [dbo].[ScheduledMatch] WITH NOCHECK
    ADD CONSTRAINT [ScheduledMatch_FK2] FOREIGN KEY ([MatchID]) REFERENCES [dbo].[Match] ([MatchID]);


GO
PRINT N'Creating [dbo].[Standing_FK]...';


GO
ALTER TABLE [dbo].[Standing] WITH NOCHECK
    ADD CONSTRAINT [Standing_FK] FOREIGN KEY ([TeamID]) REFERENCES [dbo].[Team] ([TeamID]);


GO
PRINT N'Creating [dbo].[WorksForTeam_FK]...';


GO
ALTER TABLE [dbo].[WorksForTeam] WITH NOCHECK
    ADD CONSTRAINT [WorksForTeam_FK] FOREIGN KEY ([TeamID]) REFERENCES [dbo].[Team] ([TeamID]);


GO
PRINT N'Creating [dbo].[WorksForTeam_FK2]...';


GO
ALTER TABLE [dbo].[WorksForTeam] WITH NOCHECK
    ADD CONSTRAINT [WorksForTeam_FK2] FOREIGN KEY ([TeamStaffID]) REFERENCES [dbo].[TeamStaff] ([TeamStaffID]);


GO
-- Refactoring step to update target server with deployed transaction logs

IF OBJECT_ID(N'dbo.__RefactorLog') IS NULL
BEGIN
    CREATE TABLE [dbo].[__RefactorLog] (OperationKey UNIQUEIDENTIFIER NOT NULL PRIMARY KEY)
    EXEC sp_addextendedproperty N'microsoft_database_tools_support', N'refactoring log', N'schema', N'dbo', N'table', N'__RefactorLog'
END
GO
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '8600449f-7300-46aa-b821-eb092f2b9af3')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('8600449f-7300-46aa-b821-eb092f2b9af3')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '3a7dc3d6-4d8c-4f5d-b342-0440da1c9e88')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('3a7dc3d6-4d8c-4f5d-b342-0440da1c9e88')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '2169d87d-d83e-4312-aa4d-e7c821de21ba')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('2169d87d-d83e-4312-aa4d-e7c821de21ba')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '2194103b-69fc-4c35-b499-9b7e0ae25bfd')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('2194103b-69fc-4c35-b499-9b7e0ae25bfd')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'f0a0c595-f335-48ea-92d8-f378cdd6ba71')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('f0a0c595-f335-48ea-92d8-f378cdd6ba71')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '492c7750-c910-4c18-b4dd-dc6a6a7bfdfd')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('492c7750-c910-4c18-b4dd-dc6a6a7bfdfd')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'e10332e6-953a-4042-b6d0-d68f4db19d6f')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('e10332e6-953a-4042-b6d0-d68f4db19d6f')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'e697a75e-c862-4477-af4f-619cdffa84a6')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('e697a75e-c862-4477-af4f-619cdffa84a6')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '46c18766-5333-4a6b-9810-2904b5eda2f2')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('46c18766-5333-4a6b-9810-2904b5eda2f2')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '8f4bac8c-7931-4323-8a92-0b3636896154')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('8f4bac8c-7931-4323-8a92-0b3636896154')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'c64b7ff7-1004-4522-8d66-b4fb49d01040')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('c64b7ff7-1004-4522-8d66-b4fb49d01040')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'f62f9224-3805-4644-8b23-a09c288f9170')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('f62f9224-3805-4644-8b23-a09c288f9170')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'bf87c9a1-30a4-4a44-afcf-29939fa59b27')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('bf87c9a1-30a4-4a44-afcf-29939fa59b27')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '8a35aede-abc9-4fca-9f24-1d179cb148ee')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('8a35aede-abc9-4fca-9f24-1d179cb148ee')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'f4a18c36-b9db-44aa-aef6-dabf71f9d9aa')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('f4a18c36-b9db-44aa-aef6-dabf71f9d9aa')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'da648b40-ec0e-4c2e-9de7-76495f5762fd')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('da648b40-ec0e-4c2e-9de7-76495f5762fd')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '9ebc9d4b-e4f3-40ee-8611-135f1d5adab2')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('9ebc9d4b-e4f3-40ee-8611-135f1d5adab2')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '5f421b39-71c1-4895-a163-152e7da78185')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('5f421b39-71c1-4895-a163-152e7da78185')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '5537c09a-ad21-46ae-aaab-d7f7c5082d97')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('5537c09a-ad21-46ae-aaab-d7f7c5082d97')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '4b3901bb-d881-42de-9eb7-275cd45fb169')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('4b3901bb-d881-42de-9eb7-275cd45fb169')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'a4ad704b-d506-404d-be1e-135fe64f5e71')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('a4ad704b-d506-404d-be1e-135fe64f5e71')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '5e12ef8a-1c24-4119-ab08-ac3721359558')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('5e12ef8a-1c24-4119-ab08-ac3721359558')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '39a98983-adb9-4097-a220-99b091c5c7ae')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('39a98983-adb9-4097-a220-99b091c5c7ae')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'd9d90403-6d42-42af-b66b-8f761a67b3c0')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('d9d90403-6d42-42af-b66b-8f761a67b3c0')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '220b58a0-89b9-45de-baf0-3f4f088bc0c7')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('220b58a0-89b9-45de-baf0-3f4f088bc0c7')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'cb1d74cd-ed82-412a-9ed6-bca9c0a3de29')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('cb1d74cd-ed82-412a-9ed6-bca9c0a3de29')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '439209e9-0301-4e45-bca5-f72684c7c306')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('439209e9-0301-4e45-bca5-f72684c7c306')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'd567db1c-efd6-493a-8cdb-fcd543fd7c6f')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('d567db1c-efd6-493a-8cdb-fcd543fd7c6f')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'eed50385-7b32-4733-8d44-c43661d1b4e5')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('eed50385-7b32-4733-8d44-c43661d1b4e5')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'dcb32c6b-ded7-418c-847c-0e155b60eaef')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('dcb32c6b-ded7-418c-847c-0e155b60eaef')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '6dd66ec2-5b9e-42b1-8ffc-cf3959be9c56')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('6dd66ec2-5b9e-42b1-8ffc-cf3959be9c56')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '12bb863f-a045-4f8f-becf-4b33ae8d5e2c')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('12bb863f-a045-4f8f-becf-4b33ae8d5e2c')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '7ae07983-c870-4037-bdc9-fa0a3e0ebc2b')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('7ae07983-c870-4037-bdc9-fa0a3e0ebc2b')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'd778d721-0005-42ef-974e-229175f97d0a')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('d778d721-0005-42ef-974e-229175f97d0a')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '21285f1b-a207-4d74-b2b5-ee03be67b7a0')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('21285f1b-a207-4d74-b2b5-ee03be67b7a0')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '96ed880c-06fd-4bbb-8a9c-b097b1d38433')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('96ed880c-06fd-4bbb-8a9c-b097b1d38433')

GO

GO
PRINT N'Checking existing data against newly created constraints';


GO
USE [$(DatabaseName)];


GO
ALTER TABLE [dbo].[AnalyticalCaster] WITH CHECK CHECK CONSTRAINT [AnalyticalCaster_FK];

ALTER TABLE [dbo].[Caster] WITH CHECK CHECK CONSTRAINT [Caster_FK];

ALTER TABLE [dbo].[FeaturesInMedia] WITH CHECK CHECK CONSTRAINT [FeaturesInMedia_FK];

ALTER TABLE [dbo].[FeaturesInMedia] WITH CHECK CHECK CONSTRAINT [FeaturesInMedia_FK2];

ALTER TABLE [dbo].[Host] WITH CHECK CHECK CONSTRAINT [Host_FK];

ALTER TABLE [dbo].[IsOnMedia] WITH CHECK CHECK CONSTRAINT [IsOnMedia_FK];

ALTER TABLE [dbo].[IsOnMedia] WITH CHECK CHECK CONSTRAINT [IsOnMedia_FK2];

ALTER TABLE [dbo].[Match] WITH CHECK CHECK CONSTRAINT [Match_FK];

ALTER TABLE [dbo].[Match] WITH CHECK CHECK CONSTRAINT [Match_FK2];

ALTER TABLE [dbo].[Match] WITH CHECK CHECK CONSTRAINT [Match_FK3];

ALTER TABLE [dbo].[MatchTicket] WITH CHECK CHECK CONSTRAINT [MatchTicket_FK];

ALTER TABLE [dbo].[MatchTicket] WITH CHECK CHECK CONSTRAINT [MatchTicket_FK2];

ALTER TABLE [dbo].[MatchTicket] WITH CHECK CHECK CONSTRAINT [MatchTicket_FK3];

ALTER TABLE [dbo].[ScheduledMatch] WITH CHECK CHECK CONSTRAINT [ScheduledMatch_FK];

ALTER TABLE [dbo].[ScheduledMatch] WITH CHECK CHECK CONSTRAINT [ScheduledMatch_FK2];

ALTER TABLE [dbo].[Standing] WITH CHECK CHECK CONSTRAINT [Standing_FK];

ALTER TABLE [dbo].[WorksForTeam] WITH CHECK CHECK CONSTRAINT [WorksForTeam_FK];

ALTER TABLE [dbo].[WorksForTeam] WITH CHECK CHECK CONSTRAINT [WorksForTeam_FK2];


GO
PRINT N'Update complete.';


GO
